<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, user-scalable=no"
    />
    <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
    <!-- Use a stable CDN for AR.js -->
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.5/aframe/build/aframe-ar.js"></script>
    <style>
      html,
      body {
        margin: 0;
        height: 100%;
        overflow: hidden;
      }
      #status {
        position: fixed;
        top: 8px;
        left: 8px;
        z-index: 9999;
        background: rgba(0, 0, 0, 0.6);
        color: #fff;
        padding: 6px 10px;
        border-radius: 6px;
        font-family: system-ui, sans-serif;
        font-size: 14px;
      }
    </style>
    <script>
      AFRAME.registerComponent("face-camera-yaw", {
        tick: function () {
          const cam = this.el.sceneEl.camera;
          if (!cam) return;
          const obj = this.el.object3D;

          // Get world position of this object and camera
          const p = new THREE.Vector3();
          const c = new THREE.Vector3();
          obj.getWorldPosition(p);
          cam.getWorldPosition(c);

          // Ignore vertical difference to keep it upright (no flip)
          c.y = p.y;
          obj.lookAt(c);
        },
      });
    </script>
  </head>
  <body>
    <div id="status">Camera starting…</div>

    <a-scene
      embedded
      vr-mode-ui="enabled:false"
      renderer="logarithmicDepthBuffer:true"
      arjs="sourceType:webcam; facingMode:environment; sourceWidth:1280; sourceHeight:720; displayWidth:1280; displayHeight:720; debugUIEnabled:true; patternRatio:0.90;"
    >
      <!-- Built-in HIRO marker (no external .patt URL) -->
      <a-marker type="pattern" url="pattern-ar-marker.patt" id="m">
        <!-- Center -->
        <a-image
          id="main"
          src="main.png"
          width="2"
          height="2"
          position="0 0 0"
          rotation="0 0 0"
          face-camera-yaw
        ></a-image>

        <!-- Left -->
        <a-image
          id="linkedin"
          src="linkedin.png"
          width="2"
          height="2"
          position="-1.6 0 0"
          rotation="0 0 0"
          face-camera-yaw
        ></a-image>

        <!-- Right -->
        <a-image
          id="github"
          src="github.png"
          width="2"
          height="2"
          position="1.6 0 0"
          rotation="0 0 0"
          face-camera-yaw
        ></a-image>

        <!-- Up -->
        <a-image
          id="resume"
          src="resume.png"
          width="2"
          height="2"
          position="0 1.3 0"
          rotation="0 0 0"
          face-camera-yaw
        ></a-image>

        <!-- Down -->
        <a-image
          id="transcript"
          src="transcript.png"
          width="2"
          height="2"
          position="0 -1.3 0"
          rotation="0 0 0"
          face-camera-yaw
        ></a-image>
      </a-marker>

      <a-entity camera></a-entity>
    </a-scene>

    <script>
      const s = document.getElementById("status");
      const marker = document.getElementById("m");

      // Scene ready
      document.querySelector("a-scene").addEventListener("loaded", () => {
        s.textContent = "Scene loaded. Point at HIRO marker.";
      });

      // Marker events
      marker.addEventListener("markerFound", () => {
        s.textContent = "✅ Marker FOUND";
      });
      marker.addEventListener("markerLost", () => {
        s.textContent =
          "❌ Marker LOST — hold steady, good lighting, fill more of the view";
      });
    </script>
  </body>
</html>
